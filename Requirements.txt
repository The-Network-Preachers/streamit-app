numpy                     1.21.5           py39h7a0a035_3
scikit-learn              1.1.3            py39hd77b12b_0
threadpoolctl             3.1.0              pyh8a188c0_0 

All the above modules in their mentioned versions are required for this to function well.

To completely understand the working of the code, do the following

Bandwidths
10 20 30 40 50 60 70 80 90 100 110 120 150 160 170 180 190 200

and run it using max_sender=4 and max_sender=3

It will be made clear!